<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>FieloEE__ActiveInactive</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Active/Inactive</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/26.0/connection.js&quot;)}

var bannerUpdate = [];

var resultBanner = sforce.connection.query(&quot;SELECT Id, {!$Setup.FieloEE__PublicSettings__c.FieloEE__PackagePrefix__c}isActive__c FROM {!$Setup.FieloEE__PublicSettings__c.FieloEE__PackagePrefix__c}Banner__c WHERE Id = \&apos;{!FieloEE__Banner__c.Id}\&apos; &quot;);

var banner = resultBanner.getArray(&quot;records&quot;)[0];
if(banner.{!$Setup.FieloEE__PublicSettings__c.FieloEE__PackagePrefix__c}isActive__c == &apos;true&apos;){
    banner.{!$Setup.FieloEE__PublicSettings__c.FieloEE__PackagePrefix__c}isActive__c = &apos;false&apos;;
}else{
    banner.{!$Setup.FieloEE__PublicSettings__c.FieloEE__PackagePrefix__c}isActive__c = &apos;true&apos;;
}
bannerUpdate.push(banner);

result = sforce.connection.update(bannerUpdate);

if(result.toString().indexOf(&quot;errors:&quot;) != -1){
    alert(result[0].errors.message);
}
parent.location.href = &apos;{!FieloEE__Banner__c.Id}&apos;;</url>
</WebLink>
